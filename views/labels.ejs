<% layout('/layout/boilerplate') -%>

      <!-- The main content -->
      <div class="main-content">
        <form action="/fairdesk/form/labels" method="post" class="needs-validation" autocomplete="off" novalidate>
          <div class="span-full form-heading">
            <h1>Labels</h1>
          </div>

          <div class="span-full form-subheading">
            <h1>User Information</h1>
          </div>
          <div class="span-seven">
            <label for="product-id">Product ID</label>
            <input type="text" id="product-id" class="form-control" name="productId" value="FS|LAB|<%= labelsCount.toString().padStart(6, '0') %>" placeholder="Enter Product ID" readonly required />
          </div>          
          <div id="client-name-div" class="span-six">
            <div class="clientName-label"><label for="client-name">Client Name</label><span class="asterisk" style="font-size: 14px;"></span></div>
            <select name="clientName" id="client-name" class="form-control select-tag" required>
              <option value="" disabled selected hidden>Search</option>
              <% for (let client of clients) { %>
              <option value="<%= client %>"><%= client %></option>
              <% } %>
            </select>
          </div>
          <div id="user-name-div" class="span-six">
            <label for="client-user-name">User Name</label>
            <select name="userName" id="client-user-name" class="form-control select-tag" required>
              <option value="" selected disabled hidden>Search</option>
            </select>
          </div>
          <div id="user-name-contact-div" class="span-six">
            <label for="user-contact">User Contact</label>
            <input type="text" id="user-contact" class="form-control" name="userContact" placeholder="Enter User Contact" required />
          </div>
          <div id="client-location-div" class="span-seven">
            <label for="client-location">Location</label>
            <input type="text" id="client-location" class="form-control" name="location" placeholder="Enter Location" required />
          </div>

          <div class="span-full form-subheading">
            <h1>Job Details</h1>
          </div>
          <div class="job-info-grp span-seven" style="display: flex; align-items: center; justify-content: space-between; flex-direction: row; gap: 10px; grid-column: span 9;">
          <div class="span-four" style="flex: 1; border: none; padding: 0;">
            <label for="job-type">Job Type</label>
            <select name="jobType" id="job-type" class="form-control select-tag" required>
              <option value="PLAIN">PLAIN</option>
              <option value="COLOR">COLOR</option>
            </select>
          </div>          
          <div class="span-five job-name-div" style="flex: 1; border: none; padding: 0;">
            <label for="job-name">Job Name</label>
            <input type="text" id="job-name" class="form-control" name="jobName" placeholder="Enter Job Name" />
          </div>            
          </div>

          <div id="paper-type-div" class="span-seven ">
            <label class="color-label">No of color</label>
            <div class="color-count" style="width: 100%; display: flex; justify-content: space-between; gap: 10px;">
            <input type="number" id="front-color" class="form-control" name="frontColor" placeholder="Enter Front"/>              
            <input type="number" id="back-color" class="form-control" name="backColor" placeholder="Enter Back" />              
            </div>

            <div class="instruction-div" style="width: 100%;">
            <label for="instructions">Instructions</label>
            <input type="text" id="instructions" class="form-control" name="instructions" placeholder="Enter Instructions" />              
            </div>
          </div>

        
          <div id class="span-five">
            <label for="varnish">Varnish</label>
             <select name="varnish" id="varnish">
              <option value="NO">NO</option>
              <option value="FULL">FULL</option>
              <option value="WINDOW">WINDOW</option>
              <option value="SPOT">SPOT</option>
             </select>
          </div>
          <div class="span-five">
            <label for="foil-no">No of Foil</label>
            <input type="number" id="foil-no" class="form-control" name="foilNo" value="0" placeholder="Enter No of Foil" required />
          </div>
          <div id="paper-type-div" class="span-six">
            <label for="paper-type">Paper Type</label>
            <input type="text" id="paper-type" class="form-control" name="paperType" placeholder="Enter paper Type" required />
          </div>

          <div class="span-full form-subheading">
            <h1>Product Specifications</h1>
          </div>
          <div id="width-div" class="span-three">
            <label for="width">Width</label>
            <input type="text" id="width" class="form-control" name="labelWidth" placeholder="Enter Width" required />
          </div>
          <div id="height-div" class="span-three">
            <label for="height">Height</label>
            <input type="text" id="height" class="form-control" name="labelHeight" placeholder="Enter Height" required />
          </div>
          <div id="gap-div" class="span-three">
            <label for="gap">Gap</label>
            <input type="text" id="gap" class="form-control" name="labelGap" value="3" placeholder="Enter Gap" required />
          </div>
          <div id="ups-div" class="span-three">
            <label for="ups">Ups</label>
            <input type="text" id="ups" class="form-control" name="labelUps" placeholder="Enter Ups" required />
          </div>
          <div id="core-div" class="span-three">
            <label for="core">Core</label>

            <select name="labelCore" id="core" class="form-control select-tag" required>
              <option value="" selected disabled hidden>Select</option>
              <option value="0.5">0.5</option>
              <option value="1">1</option>
              <option value="1.5">1.5</option>
              <option value="2">2</option>
              <option value="3">3</option>
            </select>
          </div>
          <div id="per-roll-div" class="span-five">
            <label for="per-roll-qty">Per Roll QTY</label>
            <input type="text" id="per-roll-qty" class="form-control" name="perRollQty" placeholder="Enter Per Roll QTY" required />
          </div>
          <div id="first-out-div" class="span-dual" style="grid-column: span 12">
            <label for="first-out">First Out</label>
            <input type="text" id="first-out" class="form-control" name="firstOut" placeholder="Enter First Out" required />
          </div>

          <div class="span-full form-subheading">
            <h1>Cost & Pricing</h1>
          </div>
          <div id="rate-per-k-div" class="span-dual">
            <label for="rate-per-k">Rate Per 1000</label>
            <input type="text" id="rate-per-k" class="form-control" name="ratePerK" placeholder="Enter Rate Per 1000" required />
          </div>
          <div id="rate-per-label-div" class="span-dual">
            <label for="rate-per-label">Rate Per Label</label>
            <input type="text" id="rate-per-label" class="form-control" name="ratePerLabel" placeholder="Enter Rate Per Label" tabindex="-1" readonly required />
          </div>
          <div id="per-roll-div" class="span-dual">
            <label for="per-roll">Rate Per Roll</label>
            <input type="text" id="per-roll" class="form-control" name="perRoll" placeholder="Enter Rate Per Roll" tabindex="-1" readonly required />
          </div>
          <div id="sale-cost-div" class="span-dual">
            <label for="sale-cost">Sale Cost</label>
            <input type="text" id="sale-cost" class="form-control" name="saleCost" placeholder="Enter Sale Cost" tabindex="-1" readonly required />
          </div>

          <div class="span-full form-subheading">
            <h1>Order Information</h1>
          </div>
          <div id="order-qty-div" class="span-dual">
            <label for="order-qty">Minimium Order QTY</label>
            <input type="text" id="order-qty" class="form-control" name="minOrderQty" placeholder="Enter Our Order QTY" required />
          </div>
          <div id="order-qty-div" class="span-dual">
            <label for="order-qty">Order QTY</label>
            <input type="text" id="order-qty" class="form-control" name="orderQty" placeholder="Enter Total Order QTY" required />
          </div>
          <div id="rep-order-fq-div" class="span-dual">
            <label for="rep-order-fq">Repeat Order Frequency</label>
            <input type="text" id="rep-order-fq" class="form-control" name="repOrderFq" placeholder="Enter Repeat Order Frequency" required />
          </div>
          <div id="credit-term-div" class="span-dual">
            <label for="credit-term">CR</label>
            <input type="text" id="credit-term" class="form-control" name="creditTerm" placeholder="Enter Credit Term" required />
          </div>

          <!-- For storing the user id to store the label in it -->
          <input type="hidden" id="user-obj-id" name="userObjId">

          <div class="btn-grp span-full">
            <button type="submit">Save Labels</button>
          </div>
        </form>
      </div>
    <script>
      let jobType = document.querySelector("#job-type");

      function jobNameChange() {
        if (jobType.value == "PLAIN") {
          document.querySelector(".instruction-div").style.display = "block";
          document.querySelector(".color-count").style.display = "none";
          document.querySelector(".color-label").style.display = "none";
        } else if (jobType.value == "COLOR") {
          document.querySelector(".instruction-div").style.display = "none";
          document.querySelector(".color-count").style.display = "flex";
          document.querySelector(".color-label").style.display = "flex";
        }
      }
      jobType.addEventListener("change",jobNameChange);
      document.addEventListener("DOMContentLoaded",jobNameChange);

      // Mobile number formatting
      let userContact = document.querySelector("#user-contact");
      formatMobileInput(userContact);

      // Function to format mobile input
      function formatMobileInput(inputElement) {
        // Restrict to digits only on keydown
        inputElement.addEventListener('keydown', function (e) {
          const allowedKeys = ['Backspace', 'ArrowLeft', 'ArrowRight', 'Tab'];
          if (!/^\d$/.test(e.key) && !allowedKeys.includes(e.key)) {
            e.preventDefault();
          }
        });
      
        inputElement.addEventListener('input', function () {
          let digits = this.value.replace(/\D/g, '').slice(0, 10);
          this.value = digits.length > 5
            ? `${digits.slice(0, 5)} ${digits.slice(5)}`
            : digits;
        });
      }

      let jobName = document.querySelector(".job-name-div");
      
      function checkJobType() {
        if (jobType.value == "PLAIN") {
          jobName.style.display = "none";
        } else if (jobType.value == "COLOR") {
          jobName.style.display = "flex";
        }
      }

      jobName.addEventListener("change", checkJobType);
      jobType.addEventListener("change", checkJobType);
      document.addEventListener("DOMContentLoaded", checkJobType);

    </script>
